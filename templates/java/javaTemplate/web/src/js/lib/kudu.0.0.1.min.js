define("utils/utils",["require","jquery"],function(e){function r(e){var r={},n=t.Deferred();n.resolve();var o=n.promise();return r.noopPromise=function(){return o},r.isPromise=function(e){return null==e?!1:"function"==typeof e.then?!0:!1},r.isRactiveObject=function(e){return"object"==typeof e&&null!==e&&null!=e._guid?!0:!1},r.objectLength=function(e){if(Object.keys)return Object.keys(e).length;var r,t=0;for(r in e)e.hasOwnProperty(r)&&t++},r}var t=e("jquery"),r=r();return r}),define("router/router",["require","jquery","../utils/utils"],function(e){"use strict";function r(){var r=a.Deferred(),t=r.promise(),n=window.location.href.indexOf("#");if(-1===n||n===location.href.length-1){if(null==i)throw new Error("Couldn't resolve the url, "+location.href+", to a route. Please set the option 'kudu.defaultRoute' to render a default page!");return r.resolve(i),t}var o=m.urlPath(window.location.href);return 0===o.indexOf("/")&&(o=o.substr(1)),e([o],function(e){var t={path:o,ctrl:e,moduleId:o};r.resolve(t)},function(){r.reject()}),t}function t(e,r){if(null!=r){var t=a.param(r,!0);t.length>0&&(e=-1===e.indexOf("?")?e+"?"+t:e+"&"+t)}return e}function n(e){u!=e&&(g=!0)}var o,i,u,a=e("jquery"),l=e("../utils/utils"),s={},c={},f={},v={statechange:[],routeload:[]},d=[],w={},g=!1,h="",p=function(){h!=window.location.href&&(h=window.location.href,u=m.getHash(),m.fire("statechange"))},m={init:function(e){return u=m.getHash(),"undefined"==typeof e&&(e={}),m.addRoutes(e.routes),o=e.unknownRouteResolver||r,i=e.defaultRoute||null,window.addEventListener?(window.addEventListener("popstate",p,!1),window.addEventListener("hashchange",p,!1)):(window.attachEvent("popstate",p),window.attachEvent("onhashchange",p)),e.loadCurrentRouteOnStateChange!==!1&&m.on("statechange",function(){if(g)return void(g=!1);var e={};m.loadCurrentRoute(e)}),e.fireInitialStateChange!==!1&&m.fire("statechange"),m},activeRoute:{},addRoutes:function(e){for(var r in e)e.hasOwnProperty(r)&&m.addRoute(e[r]);return m},addRoute:function(e){if(d.push(e),null==e.moduleId){if(null==e.ctrl)throw new Error("route must have a ctrl or moduleId defined!");e.moduleId=e.ctrl.id}return m.addRouteByPath(e),m},addRouteAt:function(e,r){return d.splice(e,0,r),m.addRouteByPath(r),m},addRouteByPath:function(e){w[e.moduleId]=e.path},getRoutes:function(){return d},getRoutesByPath:function(){return w},on:function(e,r){return"undefined"==typeof v[e]&&(v[e]=[]),v[e].push(r),m},fire:function(e){if(v[e])for(var r=Array.prototype.slice.call(arguments,1),t=0;t<v[e].length;t++)v[e][t].apply(m,r);return m},off:function(e,r){if(v[e]){var t=v[e].indexOf(r);-1!==t&&v[e].splice(t,1)}return m},go:function(e){var r=e.ctrl;if(null==r)throw new Error("router.go() requires a 'ctrl' passed as an option !");var o=r.id;if(e.args=e.args||{},e.routeParams=e.routeParams||{},e.updateRoute===!1){var i={};i.moduleId=o,i.ctrl=r,e.route=i;var a=m.hashPath(u);return a=t(a,e.routeParams),n(a),m.setHash(a),void m.loadModule(e)}for(var l=null,s=m.findRoutesForCtrl(r),c=0;c<s.length;c++){var f=s[c],v=m.testCtrlRoute(f.path,e.routeParams);if(v){l=f;break}}if(null==l){console.error("No route matched request to Controller '"+r.id+"'! Available routes for this controller: ");for(var c=0;c<s.length;c++){var d=s[c];console.error("    ",d.path)}console.error("RouteParams used to match available Controller routes:",e.routeParams)}var w=null!=l?l.path:o;if(w instanceof RegExp)throw new Error("Cannot route to controller '"+r.id+"' since it's route path is a RegExp '"+w+"'");if(-1!==w.indexOf("*"))throw new Error("Cannot route to controller '"+r.id+"' since it's route path contains wildcards '*'. The given route for the controller is '"+w+"'");var g={};if(-1!==w.indexOf("?")){var h=m.queryString(w);h.length>0&&(g=m.parseRouteQueryParams(h)),w=w.substr(0,w.indexOf("?"))}var a="",p=e.routeParams,y=w.split("/");for(var j in y)if(y.hasOwnProperty(j)){var R=y[j];if(":"===R.charAt(0)){var q=R.substr(1),b=p[q];if(null==b||""===b)throw new Error("Cannot route to controller '"+r.id+"' since it's route requires the path parameter '"+q+"' but the only params provided are '"+JSON.stringify(p)+"'");a=a+"/"+b,delete p[q]}else a=a+"/"+R}0===a.indexOf("/")&&(a=a.substr(1));for(var P in g)if(g.hasOwnProperty(P)){if(null==p)throw new Error("Cannot route to controller '"+r.id+"' since it's route requires the query parameter '"+P+"' but no routeParams was provided");var b=p[P];if(void 0===b)throw new Error("Cannot route to controller '"+r.id+"' since it's route requires the query parameter '"+P+"' but the only routeParams provided are '"+JSON.stringify(p)+"'")}a=t(a,p),n(a),m.setHash(a),m.loadCurrentRoute(e)},setHash:function(e){window.location.hash=e},getHash:function(){var e=window.location.href.indexOf("#"),r=-1==e?"":window.location.href.substr(e+1);return 0==r.indexOf("!")&&(r=r.substr(1)),r},findRoutesForCtrl:function(e){for(var r=[],t=e.id,n=0;n<d.length;n++){var o=d[n];null==t||null==o.moduleId?e===o.ctrl&&r.push(o):t===o.moduleId&&r.push(o)}return r},testCtrlRoute:function(e,r){var t=m.parseRouteParams(e);for(var n in t)if(t.hasOwnProperty(n)){if(!r.hasOwnProperty(n))return!1;var o=t[n];if(o.segment===!0){var i=r[n];if(null==i||""==i)return!1}}return!0},loadCurrentRoute:function(e){e=e||{};for(var r=null,t=0;t<d.length;t++){var n=d[t];if(e.route=n,m.testRoute(e)){r=n;break}}return null==r||"*"===r.path?(e.route=r,m.handleUnknownRoute(e),m):(null!=r&&(e.route=r,m.loadModule(e)),m)},handleUnknownRoute:function(e){var r=o(e.route);return l.isPromise(r)?r.then(function(r){e.route=r,m.loadUnknownRoute(e)},function(){null!=e.route&&m.loadModule(e)}):(e.route=r,m.loadUnknownRoute(e)),m},loadUnknownRoute:function(e){if(e=e||{},null!=e.route){if(null==e.route.moduleId||null==e.route.path)throw new Error("unknownRouteResolver must return a route object with a valid moduleId and path or a promise that resolves to a route object!");e.route.isNew=!0,m.loadModule(e)}return m},loadModule:function(r){r=r||{};var t=r.route;m.activeRoute.active=!1,t.active=!0,m.activeRoute=t,console.log("route",t),null==t.ctrl?e([t.moduleId],function(e){m.processLoadedModule(r,e,t)},function(){}):m.processLoadedModule(r,t.ctrl,t)},urlPath:function(e){if("undefined"!=typeof s[e])return s[e];var r=e.split("/"),t="/"+r.splice(3,r.length-3).join("/"),n=t.split(/[\?#]/)[0],o=t.indexOf("#"),i=o===t.length-1;if(-1!==o&&!i){var u=t.substring(o).split("?")[0];n="#!"===u.substring(0,2)?u.substring(2):u.substring(1)}return s[e]=n,n},processLoadedModule:function(e,r,t){if(t.isNew&&(delete t.isNew,m.addRouteAt(0,t)),t.active){var n=e.urlParams;null==n&&(n=m.routeArguments(t,window.location.href),e.urlParams=n);var o={routeParams:n,module:r,args:e.args,route:t};m.fire("routeload",o)}},testRoute:function(e){var r=m.urlPath(e.url||window.location.href),t=e.route.path;if(t===r)return!0;if("*"===t)return!0;if(t instanceof RegExp)return t.test(r);if(-1===t.indexOf("*")&&-1===t.indexOf(":")&&-1===t.indexOf("?"))return!1;var n=r.split("/"),o=t.indexOf("?");-1!==o&&o!==t.length-1&&(t=t.substr(0,o));var i=t.split("/");if(n.length!==i.length)return!1;for(var u in i)if(i.hasOwnProperty(u)){var a=i[u],l=n[u];if("*"===a||":"===a.charAt(0)){if(null==l||""===l)return!1}else if(a!==l)return!1}if(-1!==o){var s=e.route.path.substr(o+1),c=m.parseRouteQueryParams(s);if(null==e.urlParams){var f=m.routeArguments(e.route,window.location.href);e.urlParams=f}for(var u in c)if(c.hasOwnProperty(u)){var v=e.urlParams[u];if(null==v)return!1}}return!0},routeArguments:function(e,r){e||(e=m.activeRoute),r||(r=window.location.href);var t={},n=m.urlPath(r),o=n.split("/"),i=[];!e||!e.path||e.path instanceof RegExp||(i=e.path.split("/"));for(var u in i)if(i.hasOwnProperty(u)){var a=i[u];if(":"===a.charAt(0)){a=a.substring(1);var l=a.indexOf("?");-1!==l&&(a=a.substr(0,l)),t[a]=o[u]}}var s=m.queryString(r),c=m.queryParamsFromSearchString(s);for(var f in c)c.hasOwnProperty(f)&&(t[f]=c[f]);return t=m.parseArguments(t)},queryString:function(e){var r=e.indexOf("?"),t="";if(-1!==r){t=e.substring(r+1);var n=t.indexOf("#");-1!==n&&(t=t.substring(0,n))}var o=e.indexOf("#"),i=e.indexOf("#!");if(-1!==o||-1!==i){var u="";u=-1!==o?e.substring(o):e.substring(i),r=u.indexOf("?"),-1!==r&&(t=u.substring(r+1))}return t},queryParams:function(e){var r=m.queryString(e),t=m.queryParamsFromSearchString(r);return t},queryParamsFromSearchString:function(e){var r={},t=e.split("&");1===t.length&&""===t[0]&&(t=[]);for(var n in t)if(t.hasOwnProperty(n)){var o=t[n],i=o.split("="),u=i.splice(1,i.length-1).join("=");r[i[0]]=u}return r},parseArguments:function(e){for(var r in e){var t=e[r];"true"===t?e[r]=!0:"false"===t?e[r]=!1:isNaN(t)||""===t||"0"===t.charAt(0)?e[r]=decodeURIComponent(t):e[r]=+t}return e},parseRouteQueryParams:function(e){var r=f[e];if(null!=r)return r;var t={},n=e.split("&");1===n.length&&""===n[0]&&(n=[]);for(var o in n)if(n.hasOwnProperty(o)){var i=n[o];t[i]={query:!0}}return f[e]=t,t},parseRouteParams:function(e){var r=c[e];if(null!=r)return r;var t=e,n={};if(null==t||""==t)return n;if(t instanceof RegExp&&(t=t.toString(),t=t.substring(1,t.length-1)),-1===t.indexOf(":")&&-1!==t.indexOf("?"))return c[e]=n,n;var o=t.indexOf("?");-1!==o&&o!==t.length-1&&(t=t.substr(0,o));var i=t.split("/");for(var u in i)if(i.hasOwnProperty(u)){var l=i[u];if(":"===l.charAt(0)){var s=l.slice(1);n[s]={segment:!0}}}if(-1!==o){var f=e.substr(o+1),v=m.parseRouteQueryParams(f);n=a.extend(n,v)}return c[e]=n,n},hashPath:function(e){0===e.indexOf("#")&&(e=e.substring(1));var r=e.indexOf("?");return r>=0&&(e=e.substring(0,r)),e}};return m}),define("utils/ajaxTracker",["require","jquery","./utils"],function(e){function r(e){function r(e){var r=e.slice();t.each(r,function(e,r){r.promise.abort()}),s=null}function n(r,n,u,a){u.then(function(r,n,i){var u;if(o(i))u={data:r,status:n,jqXHR:i,args:a};else{var l;arguments.length>0&&(l=Array.prototype.slice.call(arguments)),u={data:null,status:null,jqXHR:null,error:null,args:a,promiseArgs:l}}t(e).trigger("ajax.success",[u])},function(r,n,i){var u;if(o(r))var u={error:i,status:n,jqXHR:r,args:a};else{var l;arguments.length>0&&(l=Array.prototype.slice.call(arguments)),u={data:null,status:null,jqXHR:null,error:null,args:a,promiseArgs:l}}t(e).trigger("ajax.error",[u])}),u.always(function(n,l,s){var c;if(o(n))c={data:n,status:l,jqXHR:s,error:null,args:a};else if(o(s))c={data:null,status:l,jqXHR:n,error:s,args:a};else{var f;arguments.length>0&&(f=Array.prototype.slice.call(arguments)),c={data:null,status:null,jqXHR:null,error:null,args:a,promiseArgs:f}}t(e).trigger("ajax.complete",[c]);i.remove(r,u)}),n.then(function(r,i,u){var l;if(o(u))l={data:r,status:i,jqXHR:u,args:a};else{var c;arguments.length>0&&(c=Array.prototype.slice.call(arguments)),l={data:null,status:null,jqXHR:null,error:null,args:a,promiseArgs:c}}null==s||s==n?(t(e).trigger("ajax.stop",[l]),delete l.args,t(e).trigger("global.ajax.stop",[l]),s=null):t(e).trigger("ajax.stop",[l])},function(r,i,u){var l;if(o(r))l={error:u,status:i,jqXHR:r,args:a};else{var c;arguments.length>0&&(c=Array.prototype.slice.call(arguments)),l={data:null,status:null,jqXHR:null,error:null,args:a,promiseArgs:c}}return null!=s&&s!=n?void t(e).trigger("ajax.stop",[l]):(t(e).trigger("ajax.stop",[l]),delete l.args,t(e).trigger("global.ajax.stop",[l]),s=null,void 0)}),n.always(function(){})}function o(e){return null!=e&&"function"==typeof e.getAllResponseHeaders&&"function"==typeof e.abort?!0:!1}if(null==e)throw new Error("ajaxTracker requires a kudu instance!");var i={},u=0,a=0,l={},s=null;return i.add=function(r,o,i){if("function"!=typeof o.abort)throw new Error("ajaxTracker.add(promise) requires an 'abort' function for when views are cancelled!");var c=l[r];null==c&&(c=[],l[r]=c);var f={promise:o,args:i};c.push(f);var v={jqXHR:o,args:i};return null==s?(s=t.when(o),t(e).trigger("global.ajax.start",[v]),v.args=i,t(e).trigger("ajax.start",[v])):(s=t.when(s,o),v.args=i,t(e).trigger("ajax.start",[v])),s._id=u++,n(r,s,o,i),a++,s},i.remove=function(e,r){var t=l[e];if(null==t)return!1;for(var n=-1,o=0;o<t.length;o++){var i=t[o];if(i.promise===r){n=o;break}}return n>=0?(t.splice(n,1),0===t.length&&delete l[e],a--,!0):!1},i.clear=function(e){0===arguments.length?l={}:delete l[e]},i.abort=function(e){if(0===arguments.length){for(var t in l)if(l.hasOwnProperty(t)){var n=l[t];r(n)}return void r(n)}var n=l[e];null!=n&&r(n)},i}var t=e("jquery");e("./utils");return r}),define("utils/simpleAjaxTracker",["require"],function(e){var r={};return r.create=function(e,r){var t={add:function(t,n){e.add(r.target,t,n)},remove:function(t){e.remove(r.target,t)},abort:function(){e.abort(r.target)}};return t},r}),define("lifecycle/onInitHandler",["require","jquery"],function(e){function r(e){var r=t.Deferred(),n=r.promise();if("function"!=typeof e.ctrl.onInit)return r.reject("Controllers *must* implement an onInit method that returns either a Ractive function or a promise that resolves to a Ractive function!"),n;var o={routeParams:e.routeParams,args:e.args,ajaxTracker:e.ajaxTracker},i=e.ctrl.onInit(o);return r.resolve(i),n}var t=e("jquery");return r}),define("lifecycle/onRemoveHandler",["require","jquery","../utils/utils"],function(e){function r(e){var r=t.Deferred(),o=r.promise();if("function"!=typeof e.ctrl.onRemove)return r.resolve(),o;var i={routeParams:e.routeParams,args:e.args,view:e.view,ajaxTracker:e.ajaxTracker},u=e.ctrl.onRemove(i);return null==u||1==u?(r.resolve(),o):0==u?(r.reject("controller NaN"),o):(n.isPromise(u)?u.then(function(t){return e.mvc.requestTracker.active?void(null==t||1==t?r.resolve():r.reject()):(r.reject("Request overwritten by another view request"),o)},function(){r.reject()}):(console.warn("Ignoring new view since onRemove did not return a valid response. onRemove must return either true/false or a promise that resolves to true/false."),r.reject()),o)}var t=e("jquery"),n=e("../utils/utils");return r}),define("ractivelib/setupEvents",["require","jquery"],function(e){function r(e){if(e.view.off){e.view.off("complete"),e.view.off("render"),e.view.off("unrender"),e.view.off("teardown"),e.view.on("complete",function(){this.transitionsEnabled=!0}),e.view.on("render",function(){}),e.view.on("unrender",function(){}),e.view.on("teardown",function(){});var r={};return r}}e("jquery");return r}),define("ractivelib/setupDefaultEvents",["require","jquery","ractive"],function(e){function r(e){t.defaults.onconstruct=function(){};var r={};return r}var t=(e("jquery"),e("ractive"));return r}),define("transition/fade",["require","jquery"],function(e){function r(){var e={};return e.intro=function(e,r){var n=e.target;if(null==n)throw new Error("options.target is not defined!");var o=e.duration||"fast";e.firstView&&(o=0),t(e.target).fadeIn(o,function(){r()})},e.outro=function(e,r){var n=e.target;if(null==n)throw new Error("options.target is not defined!");var o=e.duration||"fast";e.firstView&&(o=0),t(e.target).fadeOut(o,function(){r()})},e}var t=e("jquery");return r()}),define("transition/intro",["require","jquery","./fade"],function(e){function r(e){var r=t.Deferred(),o=r.promise();if(e.fx!==!0)return r.resolve(),o;var i=e.intro||n.intro;return i(e,r.resolve),o}var t=e("jquery"),n=e("./fade");return r}),define("transition/outro",["require","jquery","./fade"],function(e){function r(e){var r=t.Deferred(),o=r.promise();if(e.fx!==!0)return r.resolve(),o;var i=e.outro||n.outro;return i(e,r.resolve),o}var t=e("jquery"),n=e("./fade");return r}),define("utils/severity",["require"],function(e){function r(){this.DEBUG=0,this.INFO=1,this.WARNING=2,this.ERROR=3}return new r}),define("ractivelib/render/create",["require","jquery","../../utils/utils","../../utils/severity"],function(e){function r(e){var r=t.Deferred(),i=r.promise();if(null==e.viewOrPromise)return console.warn("Ignoring view since onInit returned null. onInit must return either a Ractive function or a promise that resolves to a Ractive function."),r.reject({level:o.INFO,message:"Ignoring view since onInit returned null. onInit must return either a Ractive function or a promise that resolves to a Ractive function."}),i;if(n.isPromise(e.viewOrPromise))e.viewOrPromise.then(function(t){if("function"==typeof t&&(t=new t),!e.mvc.requestTracker.active)return r.reject("Request overwritten by another view request"),i;var n=t;r.resolve(n)},function(){e.mvc.requestTracker.active||0!==arguments.length?r.reject.apply(r,arguments):r.reject("Request overwritten by another view request")});else if(t.isFunction(e.viewOrPromise)){var u=new e.viewOrPromise;r.resolve(u)}else if(n.isRactiveObject(e.viewOrPromise)){var u=e.viewOrPromise;r.resolve(u)}else console.warn("Ignoring view since onInit did not return a valid response. onInit must return either a Ractive function or a promise that resolves to a Ractive function."),r.reject("Ignoring view since onInit did not return a valid response. onInit must return either a Ractive function or a promise that resolves to a Ractive function.");return i}var t=e("jquery"),n=e("../../utils/utils"),o=e("../../utils/severity");return r}),define("ractivelib/render/render",["require","jquery"],function(e){function r(e){var r=t.Deferred(),n=r.promise();return e.view.transitionsEnabled=!1,e.view.render(e.target).then(function(){e.view.transitionsEnabled=!0,r.resolve(e.view)},function(t){r.reject(t,e.view)}),n}var t=e("jquery");return r}),define("ractivelib/render/unrender",["require","jquery"],function(e){function r(e){var r=t.Deferred(),n=r.promise();return e.mvc.view.transitionsEnabled=!1,e.mvc.view.unrender().then(function(){r.resolve(e.view)},function(t){r.reject(t,e.view)}),n}var t=e("jquery");return r}),define("ractivelib/RactiveViewFactory",["require","./render/create","./render/render","./render/unrender"],function(e){function r(){var e={};return e.createView=function(e){return t(e)},e.renderView=function(e){return n(e)},e.unrenderView=function(e){return o(e)},e}var t=e("./render/create"),n=e("./render/render"),o=e("./render/unrender");return new r}),define("kudu",["require","./router/router","jquery","ractive","./utils/ajaxTracker","./utils/simpleAjaxTracker","./lifecycle/onInitHandler","./lifecycle/onRemoveHandler","./ractivelib/setupEvents","./ractivelib/setupDefaultEvents","./transition/intro","./transition/outro","./ractivelib/RactiveViewFactory","./utils/severity","./utils/utils"],function(e){function r(){function e(e){var r=n.Deferred(),t=r.promise(),o={ctrl:e.ctrl,routeParams:e.routeParams,args:e.args,mvc:e.mvc,ajaxTracker:e.ajaxTracker,target:e.target};return R.triggerEvent("viewBeforeInit",e),a(o).then(function(t){e.viewOrPromise=t,R.createView(e).then(function(t){e.view=t,e.kudu=R,R.triggerEvent("viewInit",e),R.processNewView(e).then(function(e){h(),r.resolve()},function(){h(),r.reject.apply(r,arguments)})},function(){h(),r.reject.apply(r,arguments)})},function(){h(),r.reject.apply(r,arguments)}),t}function r(e){var r=n.Deferred(),t=r.promise(),o={ctrl:b.ctrl,view:b.view,routeParams:b.options.routeParams,args:b.options.args,mvc:e.mvc,ajaxTracker:b.options.ajaxTracker,target:b.options.target};return l(o).then(function(){R.triggerEvent("viewBeforeUnrender",e),r.resolve()},function(){null!=b.view&&(b.view.transitionsEnabled=!0),r.reject.apply(r,arguments)}),t}function h(){P.splice(0,1),0===P.length?(console.log("AT 0"),q.enable=!1,q={enable:!0},p(q)):console.log("AT ",P.length)}function p(e){setTimeout(function(){e.enable&&(n.fx.off=!1)},350)}function m(e,r){var t=r;n.isArray(r)||(t=Array.prototype.slice.call(r)),e.error=t,R.triggerEvent("viewFail",e),x.debug&&(0===e.error.length?console.error("error occurred!",e):console.error(e.error[0],e))}function y(e){e.mvc.requestTracker.active!==!1&&(e.mvc.requestTracker.active=!1,O.abort(e.target),O.clear(e.target))}function j(e,r){e.id||Object.defineProperty(e,"id",{enumerable:!1,writable:!1,value:r})}var R={},q={enable:!0},b={view:null,ctrl:null,requestTracker:{active:!0},route:null,options:null},P=[],x={target:null,routes:null,defaultRoute:null,unknownRouteResolver:null,intro:null,outro:null,fx:!1,viewFactory:d,debug:!0},O=i(R);return R.init=function(e){n.extend(x,e),R.validateInitOptions(x),o.DEBUG=x.debug,t.on("routeload",function(e){R.routeLoaded(e)}),c(e),t.init({routes:x.routes,defaultRoute:e.defaultRoute,unknownRouteResolver:e.unknownRouteResolver})},R.router=function(){return t},R.validateInitOptions=function(e){if(null==e.viewFactory)throw new Error("viewFactory cannot be null!");if(null==e.viewFactory.createView)throw new Error("viewFactory must provide a createView function!");if(null==e.viewFactory.renderView)throw new Error("viewFactory must provide a renderView function!");if(null==e.viewFactory.unrenderView)throw new Error("viewFactory must provide an unrenderView function!")},R.route=function(e){t.go(e)},R.getDefaultTarget=function(){return x.target},R.routeLoaded=function(t){try{P.push(1),t.target=t.target||x.target,t.routeParams=t.routeParams||{},t.args=t.args||{},t.ajaxTracker=u.create(O,t),t.mvc=n.extend({},b),y(t);var o={active:!0};b.requestTracker=o,t.mvc.requestTracker=o,P.length>1&&(n.fx.off=!0,n(t.target).stop(!0,!0),q.enable=!1);var i=R.createController(t.module);t.ctrl=i,delete t.module,null==b.ctrl?e(t).then(function(){},function(){y(t);var e=arguments[0];null!=e&&e.level<w.ERROR||m(t,arguments)}):r(t).then(function(){e(t).then(function(){},function(){y(t);var e=arguments[0];null!=e&&e.level<w.ERROR||m(t,arguments)})},function(){y(t),m(t,arguments)})}catch(a){m(t,[a])}},R.createController=function(e){if(e instanceof Function){var r=new e;return null==r.id&&j(r,e.id),r}return e},R.processNewView=function(e){var r=n.Deferred(),t=r.promise();s(e);var o;return o=null!=e.route.enter||null!=b.route&&null!=b.route.leave?R.customRenderView:R.renderViewWithAnimation,o(e).then(function(){R.callViewEvent("onComplete",e),R.triggerEvent("viewComplete",e),r.resolve(e.view)},function(e,t){r.reject(e,t)}),e.mvc.requestTracker.active||r.reject("Request overwritten by another view request"),t},R.callViewEvent=function(e,r){var t=r.ctrl;if("function"==typeof t[e]){var n={routeParams:r.routeParams,args:r.args,view:r.view,ajaxTracker:r.ajaxTracker};t[e](n)}},R.triggerEvent=function(e,r){r=r||{},r.mvc=r.mvc||{};var t=x.target===r.target,o=r.ctrl;null==o&&(o={});var i={oldCtrl:r.mvc.ctrl,newCtrl:o,isMainCtrl:t,ctrlOptions:r,eventName:e,error:r.error};n(R).trigger(e,[i])},R.enter=function(e){var r=n.Deferred(),t=r.promise(),o={duration:"fast",target:e.target,intro:x.intro,fx:x.fx||!1};return null==b.ctrl&&(o.firstView=!0),R.renderView(e).then(function(){f(o).then(function(){r.resolve(e.view)})},function(e,t){r.reject(e,t)}),t},R.leave=function(e){var r=n.Deferred(),t=r.promise(),o={duration:100,target:e.target,outro:x.outro,fx:x.fx||!1};return null==b.ctrl&&(o.firstView=!0,o.duration=0),v(o).then(function(){return e.mvc.requestTracker.active?void R.unrenderView(e).then(function(){r.resolve(e.view)},function(e,t){r.reject(e,t)}):void r.reject("Request overwritten by another view request",e.view)}),t},R.renderViewWithAnimation=function(e){var r=n.Deferred(),t=r.promise();return R.leave(e).then(function(){R.enter(e).then(function(){r.resolve(e.view)},function(e,t){r.reject(e,t)})},function(e,t){r.reject(e,t)}),t},R.customLeave=function(e){var r,t,o=n.Deferred(),i=o.promise(),u={ctrl:e.ctrl,prevCtrl:b.ctrl,view:e.view,prevView:b.view,route:e.route,prevRoute:b.route,target:e.target};null==e.mvc.view?(r=function(){},t=g.noopPromise):(null!=b.route&&(r=b.route.leave,t=R.unrenderViewCleanup),null==r&&(r=R.leave,t=g.noopPromise,u=e));var a=r(u);return null==a&&(a=g.noopPromise()),a.then(function(){t(e).then(function(){return e.mvc.requestTracker.active?void o.resolve():void o.reject("Request overwritten by another view request",e.mvc.view)},function(r){o.reject(r,e.view)})},function(){o.reject("Error during route.leave()")}),i},R.customEnter=function(e){var r=n.Deferred(),t=r.promise(),o={ctrl:e.ctrl,prevCtrl:b.ctrl,view:e.view,prevView:b.view,route:e.route,prevRoute:b.route,target:e.target},i=e.route.enter,u=R.renderViewCleanup;null==i&&(i=R.enter,u=g.noopPromise,o=e);var a=i(o);return null==a&&(a=g.noopPromise()),a.then(function(){u(e).then(function(){r.resolve(e.view)},function(t){r.reject(t,e.view)})},function(){r.reject("Error during route.enter()")}),t},R.customRenderView=function(e){var r=n.Deferred(),t=r.promise();return R.customLeave(e).then(function(){R.customEnter(e).then(function(){r.resolve(e.view)},function(e,t){r.reject(e,t)})},function(e,t){r.reject(e,t)}),t},R.createView=function(e){var r=x.viewFactory.createView(e);return r},R.renderView=function(e){var r=n.Deferred(),t=r.promise(),o=x.viewFactory.renderView(e);return o.then(function(){R.renderViewCleanup(e).then(function(){r.resolve(e.view)},function(t){r.reject(t,e.view)})},function(t){r.reject(t,e.view)}),t},R.renderViewCleanup=function(e){var r=n.Deferred(),t=r.promise();R.updateMVC(e);try{R.callViewEvent("onRender",e),R.triggerEvent("viewRender",e)}catch(o){return r.reject(o),t}return r.resolve(),t},R.unrenderView=function(e){var r=n.Deferred(),t=r.promise();if(null==e.mvc.view)r.resolve();else{var o=x.viewFactory.unrenderView(e);o.then(function(){R.unrenderViewCleanup(e).then(function(){return e.mvc.requestTracker.active?void r.resolve(e.mvc.view):void r.reject("Request overwritten by another view request",e.mvc.view)},function(t){r.reject(t,e.view)})},function(){r.reject(e.mvc.view)})}return t},R.unrenderViewCleanup=function(e){var r=n.Deferred(),t=r.promise();try{R.callViewEvent("onUnrender",e),R.triggerEvent("viewUnrender",e)}catch(o){return r.reject(o),t}return r.resolve(),t},R.updateMVC=function(e){b.view=e.view,b.ctrl=e.ctrl,b.options=e,b.route=e.route},R}var t=e("./router/router"),n=e("jquery"),o=e("ractive"),i=e("./utils/ajaxTracker"),u=e("./utils/simpleAjaxTracker"),a=e("./lifecycle/onInitHandler"),l=e("./lifecycle/onRemoveHandler"),s=e("./ractivelib/setupEvents"),c=e("./ractivelib/setupDefaultEvents"),f=e("./transition/intro"),v=e("./transition/outro"),d=e("./ractivelib/RactiveViewFactory"),w=e("./utils/severity"),g=e("./utils/utils"),h=r();return h});
//# sourceMappingURL=kudu.0.0.1.min.js.map